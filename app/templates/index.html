<!DOCTYPE html>
<html>

<head>
    <title>Flash Card Viewer</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed; /* Optional: enforce width constraints */
        }

        th, td {
            padding: 8px;
            border: 1px solid #ccc;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        th:nth-child(1), td:nth-child(1) { width: 200px; } /* Word */
        th:nth-child(2), td:nth-child(2) { width: 250px; } /* Pinyin */
        th:nth-child(3), td:nth-child(3) { width: 100%; }  /* Definition */
        th:nth-child(4), td:nth-child(4) { width: 80px; text-align: center; } /* Score */
    </style>
</head>

<body>
    <h1>Flash Card Viewer</h1>
    <form method="post">
        <label for="category">Category:</label>
        <select name="category_id" id="category" required>
            {% for category in categories %}
                <option value="{{ category.id }}" {% if category.id == selected_category %}selected{% endif %}>
                    {{ category.name }}
                </option>
            {% endfor %}
        </select>

        <label for="max_score">Max Score:</label>
        <input type="number" name="max_score" id="max_score" value="{{ max_score }}" required>

        <button type="submit">Filter</button>
    </form>

    {% if cards %}
    <h2>Results</h2>
    <table border="1">
        <thead>
            <tr>
                <th>Word</th>
                <th>Pinyin</th>
                <th>Definition</th>
                <th>Score</th>
            </tr>
        </thead>
        <tbody>
            {% for card in cards %}
            <tr>
                <td>{{ card.hw }}</td>
                <td class="reveal-on-click" data-content="{{ card.pron }}">
                    <span class="hidden-content">Click to reveal</span>
                </td>
                <td class="reveal-on-click" data-content="{{ card.defn }}">
                    <span class="hidden-content">Click to reveal</span>
                </td>
                <td>{{ card.score.score if card.score else 'N/A' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        document.querySelectorAll('.reveal-on-click').forEach(function (cell) {
            const originalContent = cell.getAttribute('data-content');
            const placeholder = 'Click to reveal';
            let revealed = false;

            cell.innerHTML = `<span class="hidden-content">${placeholder}</span>`;

            cell.addEventListener('click', function () {
                if (!revealed) {
                    cell.innerHTML = originalContent;
                    cell.classList.add('revealed');
                    revealed = true;
                } else {
                    cell.innerHTML = `<span class="hidden-content">${placeholder}</span>`;
                    cell.classList.remove('revealed');
                    revealed = false;
                }
            });
        });
    });
</script>
</body>
</html>